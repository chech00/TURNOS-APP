const auth=window.auth,db=window.db;import*as UI from"./modules/senales-ui.js";import{API_BASE_URL}from"./modules/config.js";document.addEventListener("DOMContentLoaded",()=>{const e=localStorage.getItem("userRole");if("superadmin"===e){const e=document.getElementById("li-registros"),o=document.getElementById("li-turnos"),t=document.getElementById("li-usuarios");e&&(e.style.display="block"),o&&(o.style.display="block"),t&&(t.style.display="block"),document.body.classList.add("is-admin")}else"admin"===e&&document.body.classList.add("is-admin")});let usuarioEsAdmin=!1,currentNodoName="";function verificarRolUsuario(){auth.onAuthStateChanged(e=>{e?db.collection("userRoles").doc(e.uid).get().then(e=>{if(e.exists){const o=e.data().rol;localStorage.setItem("userRole",o),usuarioEsAdmin="admin"===o||"superadmin"===o,usuarioEsAdmin?document.body.classList.add("is-admin"):document.body.classList.remove("is-admin");const t=document.getElementById("li-registros"),r=document.getElementById("li-turnos"),a=document.getElementById("li-usuarios");if("superadmin"===o){t&&(t.style.display="block"),r&&(r.style.display="block"),a&&(a.style.display="block");const e=document.getElementById("li-animaciones");e&&(e.style.display="block"),"function"==typeof refreshIcons?refreshIcons():"undefined"!=typeof lucide&&lucide.createIcons()}}else usuarioEsAdmin=!1,localStorage.removeItem("userRole"),document.body.classList.remove("is-admin");cargarNodos()}).catch(e=>{console.error("Error al obtener rol:",e),usuarioEsAdmin=!1,cargarNodos()}):window.location.href="login.html"})}function configurarSidebar(){const e=document.getElementById("sidebar"),o=document.getElementById("main-content"),t=document.querySelectorAll("#menu-toggle");e&&o&&0!==t.length?(t.forEach(t=>{t.addEventListener("click",()=>{e.classList.toggle("expanded"),o.classList.toggle("expanded")})}),lucide.createIcons()):console.error("No se encontró el sidebar o main content.")}function configurarLogout(){const e=document.getElementById("logout-btn");e&&e.addEventListener("click",()=>{auth.signOut().then(()=>{localStorage.removeItem("userRole"),window.location.href="login.html"}).catch(e=>{console.error("Error al cerrar sesión:",e)})})}function cargarNodos(){const e=document.getElementById("fiber-structure");UI.renderRoomHeader(e,usuarioEsAdmin);const o=document.getElementById("kml-import-btn");o&&o.remove(),db.collection("Nodos").orderBy("name").get().then(o=>{const t=document.createElement("div");t.classList.add("rack-aisle-grid");const r=[];o.forEach(e=>{const o=e.data(),a=e.id,n=o.name,i=contarDatosNodo(a).then(e=>{const o=UI.createRackElement(a,n,e,usuarioEsAdmin);t.appendChild(o)});r.push(i)}),Promise.all(r).then(()=>{e.appendChild(t),lucide.createIcons()})}).catch(o=>{console.error("Error al cargar nodos:",o),e.innerHTML+="<p>Error cargando la sala de servidores.</p>"})}async function contarDatosNodo(e){const o=`node_stats_v2_${e}`,t=localStorage.getItem(o);if(t)try{const{timestamp:e,data:o}=JSON.parse(t);if(Date.now()-e<3e5)return o}catch(e){localStorage.removeItem(o)}let r=0,a=0;try{const t=(await db.collection("Nodos").doc(e).collection("PONLetters").get()).docs.map(async o=>{const t=db.collection("Nodos").doc(e).collection("PONLetters").doc(o.id).collection("PONs"),r=await t.get(),a=r.size,n=r.docs.map(async e=>(await t.doc(e.id).collection("Cajas").get()).size);return{p:a,c:(await Promise.all(n)).reduce((e,o)=>e+o,0)}});(await Promise.all(t)).forEach(e=>{r+=e.p,a+=e.c}),localStorage.setItem(o,JSON.stringify({timestamp:Date.now(),data:{totalPONs:r,totalCajas:a}}))}catch(o){console.error(`Error contando datos para nodo ${e}:`,o)}return{totalPONs:r,totalCajas:a}}function eliminarNodo(e){usuarioEsAdmin?db.collection("Nodos").doc(e).delete().then(()=>{Swal.fire("Éxito","Nodo eliminado","success"),cargarNodos()}).catch(e=>{console.error("Error al eliminar nodo:",e)}):Swal.fire("Acceso denegado","No tienes permiso para eliminar nodos.","error")}function mostrarVistaPonLetras(e,o){currentNodoName=o;const t=document.getElementById("fiber-structure");UI.renderChassisView(t,o,usuarioEsAdmin,e),cargarPonLetters(e)}function crearPonLetra(e){if(!usuarioEsAdmin)return void Swal.fire("Acceso denegado","No tienes permiso para crear PONs.","error");const o=document.getElementById("pon-letra-dropdown").value,t=db.collection("Nodos").doc(e).collection("PONLetters");t.doc(o).get().then(r=>{r.exists?Swal.fire("Error",`La letra ${o} ya existe en este nodo.`,"error"):t.doc(o).set({name:o}).then(()=>{Swal.fire("Éxito",`PON ${o} creado correctamente`,"success"),cargarPonLetters(e)}).catch(e=>{console.error("Error al crear la letra:",e)})}).catch(e=>{console.error("Error al verificar la letra:",e)})}function cargarPonLetters(e){const o=document.getElementById("pon-letters-list");o.innerHTML='<div class="spinner"></div>',db.collection("Nodos").doc(e).collection("PONLetters").orderBy("name").get().then(t=>{const r=[];t.forEach(e=>{r.push({id:e.id,...e.data()})});const a=UI.renderChassisSlots(r,usuarioEsAdmin,e);o.innerHTML=a}).catch(e=>{console.error("Error al cargar OLT:",e),o.innerHTML="<p>Error cargando visualización.</p>"})}function confirmarEliminarPonLetra(e,o,t){e.stopPropagation(),Swal.fire({title:"Desmontar Módulo",text:`¿Retirar la tarjeta PON ${t} del rack?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Sí, retirar",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&eliminarPonLetra(o,t)})}function eliminarPonLetra(e,o){usuarioEsAdmin?db.collection("Nodos").doc(e).collection("PONLetters").doc(o).delete().then(()=>{Swal.fire("Éxito",`Letra ${o} eliminada`,"success"),cargarPonLetters(e)}).catch(e=>{console.error("Error al eliminar la letra:",e)}):Swal.fire("Acceso denegado","No tienes permiso para eliminar PONs.","error")}function mostrarVistaPONPorLetra(e,o){const t=document.getElementById("fiber-structure");UI.renderFaceplateView(t,e,o,currentNodoName,usuarioEsAdmin),cargarPONs(e,o)}function crearPON(e,o){if(!usuarioEsAdmin)return void Swal.fire("Acceso denegado","No tienes permiso para crear PONs.","error");o||(o=document.getElementById("pon-letra").value);const t=document.getElementById("pon-numero").value,r=`PON ${o}${t}`,a=db.collection("Nodos").doc(e).collection("PONLetters").doc(o).collection("PONs");a.where("name","==",r).get().then(n=>{n.empty?a.add({name:r}).then(()=>{Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3}).fire({icon:"success",title:`SFP insertado en Puerto ${t}`}),cargarPONs(e,o)}).catch(e=>{console.error("Error al crear PON:",e)}):Swal.fire({icon:"error",title:"Puerto Ocupado",text:`El puerto SFP ${t} de la tarjeta ${o} ya tiene un transceptor instalado.`,confirmButtonColor:"#333"})})}function cargarPONs(e,o){const t=document.getElementById("pon-list");t.innerHTML='<div class="spinner"></div>',db.collection("Nodos").doc(e).collection("PONLetters").doc(o).collection("PONs").get().then(r=>{const a={};r.forEach(e=>{const o=e.data(),t=o.name.match(/PON\s*[A-Z]+(\d+)/i);if(t){const r=parseInt(t[1]);a[r]={id:e.id,...o}}});const n=UI.renderFaceplatePorts(a,o,e,usuarioEsAdmin);t.innerHTML=n}).catch(e=>{console.error("Error al cargar PONs:",e),t.innerHTML="<p>Error cargando panel frontal.</p>"})}function confirmarEliminarPON(e,o,t,r){e.stopPropagation(),Swal.fire({title:"Desconectar Fibra",text:"¿Retirar el módulo SFP y eliminar este PON?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Sí, desconectar",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&eliminarPON(o,t,r)})}function eliminarPON(e,o,t){usuarioEsAdmin?db.collection("Nodos").doc(e).collection("PONLetters").doc(o).collection("PONs").doc(t).delete().then(()=>{Swal.fire("Éxito","PON eliminado","success"),cargarPONs(e,o)}).catch(e=>{console.error("Error al eliminar PON:",e)}):Swal.fire("Acceso denegado","No tienes permiso para eliminar PONs.","error")}function mostrarVistaPON(e,o,t,r){const a=document.getElementById("fiber-structure");let n=`\n    <div class="olt-management-panel">\n        <div class="olt-header-left">\n            <button class="olt-header-back-btn" onclick="mostrarVistaPONPorLetra('${e}', '${o}')">\n                ← SFP FACEPLATE [BACK]\n            </button>\n            <div class="olt-info-group">\n                <span class="olt-breadcrumb">NODE: ${currentNodoName||"N/A"} > SLOT: ${o} > PON: ${r}</span>\n                <span class="olt-device-name">${r}</span>\n            </div>\n        </div>\n\n        <div class="olt-lcd-display">\n            <div class="olt-status-light"></div>\n            <span>NETWORK STATUS: ACTIVE / LIVE</span>\n        </div>\n  `;n+=usuarioEsAdmin?`\n        <div class="olt-admin-controls">\n            <span class="olt-device-label" style="font-size:0.7rem;">SPLICE BOX MGMT</span>\n            <select id="caja-numero" class="olt-select-dark">\n               ${[...Array(51)].map((e,o)=>`<option value="${o}">BOX ID ${o}</option>`).join("")}\n            </select>\n            <select id="caja-capacidad" class="olt-select-dark" style="margin-left:5px;">\n              <option value="8">8 PORTS</option>\n              <option value="12" selected>12 PORTS</option>\n              <option value="16">16 PORTS</option>\n              <option value="24">24 PORTS</option>\n            </select>\n            <button class="olt-btn-install" onclick="crearCaja('${e}', '${o}', '${t}')">\n                DEPLOY SPLICE BOX\n            </button>\n        </div>\n    `:"<div></div>",n+="</div>",n+='<div id="caja-list" class="topology-container"></div>',a.innerHTML=n,cargarCajas(e,o,t)}function crearCaja(e,o,t){if(!usuarioEsAdmin)return void Swal.fire("Acceso denegado","No tienes permiso para crear Cajas.","error");const r=document.getElementById("caja-numero").value,a=parseInt(document.getElementById("caja-capacidad").value)||12,n=`Caja ${r}`,i=db.collection("Nodos").doc(e).collection("PONLetters").doc(o).collection("PONs").doc(t).collection("Cajas");i.where("name","==",n).get().then(r=>{r.empty?i.add({name:n,capacity:a}).then(()=>{Swal.fire("Éxito",`Caja ${n} creada correctamente`,"success"),cargarCajas(e,o,t)}).catch(e=>{console.error("Error al crear Caja:",e)}):Swal.fire("Error",`La ${n} ya existe en este PON.`,"error")})}function cargarCajas(e,o,t){const r=document.getElementById("caja-list");r.innerHTML='<div class="spinner"></div>',db.collection("Nodos").doc(e).collection("PONLetters").doc(o).collection("PONs").doc(t).collection("Cajas").get().then(a=>{let n=[];a.forEach(e=>{const o=e.data();n.push({docId:e.id,name:o.name,capacity:o.capacity||12,numeric:extraerNumeroDeNombre(o.name)})}),n.sort((e,o)=>e.numeric!==o.numeric?e.numeric-o.numeric:e.name.localeCompare(o.name,void 0,{numeric:!0})),UI.renderTopologyTree(r,n,e,o,t,usuarioEsAdmin)}).catch(e=>{console.error("Error al cargar Topología:",e),r.innerHTML="<p>Error cargando la red.</p>"})}function confirmarEliminarCaja(e,o,t,r,a){e.stopPropagation(),Swal.fire({title:"Desinstalar Caja",text:"¿Cortar y retirar esta caja de empalme?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Sí, retirar",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&eliminarCaja(o,t,r,a)})}function eliminarCaja(e,o,t,r){usuarioEsAdmin?db.collection("Nodos").doc(e).collection("PONLetters").doc(o).collection("PONs").doc(t).collection("Cajas").doc(r).delete().then(()=>{Swal.fire("Éxito","Caja eliminada","success"),cargarCajas(e,o,t)}).catch(e=>{console.error("Error al eliminar Caja:",e)}):Swal.fire("Acceso denegado","No tienes permiso para eliminar Cajas.","error")}function mostrarVistaCaja(e,o,t,r,a,n=12){const i=document.getElementById("fiber-structure");let c=`\n    <div class="olt-management-panel">\n        <div class="olt-header-left">\n            <button class="olt-header-back-btn" onclick="mostrarVistaPON('${e}', '${o}', '${t}', '')">\n                ← NETWORK [BACK]\n            </button>\n            <div class="olt-info-group">\n                <span class="olt-breadcrumb">NODE: ${currentNodoName||"N/A"} > ... > PON: ${t} > BOX: ${a}</span>\n                <span class="olt-device-name">${a}</span>\n            </div>\n        </div>\n\n        <div class="olt-lcd-display">\n            <div class="olt-status-light"></div>\n            <span>TRAY STATUS: ${n} PORTS AVAIL</span>\n        </div>\n        \n        <div class="olt-admin-controls">\n             <span class="olt-device-label" style="font-size:0.7rem;">ACTION</span>\n             <button id="btn-u2000-sim" class="olt-btn-install" style="background:#444; border-color:#666;" onclick="toggleU2000Simulation()">\n                ⏱️ LIVE MONITOR (SIM)\n             </button>\n        </div>\n    </div>\n\n    \x3c!-- TRAY CONTAINER --\x3e\n    <div class="fiber-tray-container" style="border-top:none; margin-top:0;">\n      \x3c!-- GRID DE PUERTOS (Dinámico) --\x3e\n      <div id="fiber-grid" class="fiber-grid"></div>\n    </div>\n  `;i.innerHTML=c,cargarFilamentosGrid(e,o,t,r,n)}function cargarFilamentosGrid(e,o,t,r,a){const n=document.getElementById("fiber-grid");n.innerHTML='<div class="spinner"></div>';db.collection("Nodos").doc(e).collection("PONLetters").doc(o).collection("PONs").doc(t).collection("Cajas").doc(r).collection("Filamentos").get().then(i=>{n.innerHTML="";const c={};i.forEach(e=>{const o=e.data(),t=extraerNumeroDeNombre(o.name);t&&(c[t]={id:e.id,name:o.name,signal:o.signal})});const s=parseInt(a)||12;16===s?n.classList.add("layout-16"):n.classList.remove("layout-16");for(let a=1;a<=s;a++){const i=document.createElement("div"),l=c[a];let d="fiber-port",u=`<span class="port-number">${a}</span>`;const m=getTiaColorClass(a);l?(d+=` occupied ${m}`,u+=`<span class="port-signal" id="sig-${l.id}">${l.signal||"N/A"}</span>`,i.dataset.signalBase=l.signal||"-14.00",i.dataset.id=l.id,i.onclick=()=>{editarFilamento(e,o,t,r,l.id,l.name,l.signal,s)}):(u+='<span style="font-size:0.7em; opacity:0.5;">Vacío</span>',i.onclick=()=>{crearFilamentoModal(e,o,t,r,a)}),i.className=d,i.innerHTML=u,n.appendChild(i)}}).catch(e=>{console.error("Error cargando grid:",e),n.innerHTML="<p>Error cargando datos.</p>"})}function getTiaColorClass(e){switch((e-1)%12+1){case 1:return"tia-blue";case 2:return"tia-orange";case 3:return"tia-green";case 4:return"tia-brown";case 5:return"tia-slate";case 6:return"tia-white";case 7:return"tia-red";case 8:return"tia-black";case 9:return"tia-yellow";case 10:return"tia-violet";case 11:return"tia-rose";case 12:return"tia-aqua";default:return""}}async function crearFilamentoModal(e,o,t,r,a){if(!usuarioEsAdmin)return Swal.fire("Error","No tienes permisos","error");const{value:n}=await Swal.fire({title:`Conectar Filamento ${a}`,input:"text",inputLabel:"Señal Estimada (dBm)",inputValue:"-14dBm",showCancelButton:!0,confirmButtonText:"Empalmar",inputValidator:e=>{if(!e)return"Debes escribir la señal!"}});n&&crearFilamentoDirecto(e,o,t,r,a,n)}function crearFilamentoDirecto(e,o,t,r,a,n){const i=`Filamento ${a}`;db.collection("Nodos").doc(e).collection("PONLetters").doc(o).collection("PONs").doc(t).collection("Cajas").doc(r).collection("Filamentos").add({name:i,signal:n}).then(()=>{Swal.fire({icon:"success",title:"Empalme Exitoso",text:`Filamento ${a} color ${getNombreColor((a-1)%12+1)} conectado.`,timer:1500,showConfirmButton:!1}),cargarFilamentosGrid(e,o,t,r)})}async function editarFilamento(e,o,t,r,a,n,i,c){if(!usuarioEsAdmin)return;const s=await Swal.fire({title:n,text:`Señal actual: ${i||"Sin señal"}`,showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Actualizar Señal",denyButtonText:"Desconectar (Borrar)",confirmButtonColor:"#3085d6",denyButtonColor:"#d33"});if(s.isConfirmed){const{value:n}=await Swal.fire({input:"text",inputLabel:"Nueva Señal",inputValue:i||""});null!=n&&db.collection("Nodos").doc(e).collection("PONLetters").doc(o).collection("PONs").doc(t).collection("Cajas").doc(r).collection("Filamentos").doc(a).update({signal:n}).then(()=>{Swal.fire("Actualizado","Potencia actualizada correctamente","success"),cargarFilamentosGrid(e,o,t,r,c)}).catch(e=>{console.error("Error actualizando señal:",e),Swal.fire("Error","No se pudo actualizar la señal.","error")})}else s.isDenied&&db.collection("Nodos").doc(e).collection("PONLetters").doc(o).collection("PONs").doc(t).collection("Cajas").doc(r).collection("Filamentos").doc(a).delete().then(()=>{Swal.fire("Desconectado","Filamento eliminado.","success"),cargarFilamentosGrid(e,o,t,r,c)}).catch(e=>{console.error("Error eliminando filamento:",e),Swal.fire("Error","No se pudo eliminar el filamento.","error")})}function getNombreColor(e){return["Azul","Naranja","Verde","Marrón","Gris","Blanco","Rojo","Negro","Amarillo","Violeta","Rosa","Aqua"][e-1]||"Desconocido"}window.verificarRolUsuario=verificarRolUsuario,window.configurarSidebar=configurarSidebar,window.configurarLogout=configurarLogout,window.cargarNodos=cargarNodos,window.mostrarVistaPonLetras=mostrarVistaPonLetras,window.crearPonLetra=crearPonLetra,window.mostrarVistaPONPorLetra=mostrarVistaPONPorLetra,window.crearPON=crearPON,window.cargarPONs=cargarPONs,window.mostrarVistaPON=mostrarVistaPON,window.crearCaja=crearCaja,window.confirmarEliminarCaja=confirmarEliminarCaja,window.eliminarCaja=eliminarCaja,window.mostrarVistaCaja=mostrarVistaCaja,window.crearFilamento=null,window.cargarFilamentos=null;let u2000Interval=null;function toggleU2000Simulation(){const e=document.getElementById("btn-u2000-sim");if(e)if(u2000Interval){clearInterval(u2000Interval),u2000Interval=null,e.style.background="#444",e.style.borderColor="#666",e.innerHTML="⏱️ LIVE MONITOR (SIM)";document.querySelectorAll(".fiber-port.occupied").forEach(e=>{const o=e.dataset.signalBase,t=e.querySelector(".port-signal");t&&o&&(t.innerText=o)})}else e.style.background="#10b981",e.style.borderColor="#059669",e.innerHTML="⚡ MONITORING...",u2000Interval=setInterval(()=>{document.querySelectorAll(".fiber-port.occupied").forEach(e=>{const o=e.dataset.signalBase;if(!o)return;let t=parseFloat(o.replace(/[^\d.-]/g,""));isNaN(t)&&(t=-14.5);const r=(t+.4*(Math.random()-.5)).toFixed(2),a=e.querySelector(".port-signal");a&&(a.innerText=`${r} dBm`),e.style.borderColor=r<-25?"red":r<-20?"orange":"rgba(255,255,255,0.1)"})},1500)}async function crearNodo(){const{value:e}=await Swal.fire({title:"Nuevo Gabinete (Seguro)",input:"text",inputLabel:"Nombre del Nodo / Ubicación",inputPlaceholder:"Ej: Sala Servidores Piso 1",showCancelButton:!0,confirmButtonText:"Crear",confirmButtonColor:"#10b981",background:"#1f2937",color:"#fff",customClass:{input:"swal-input-dark"}});if(e)try{const o=auth.currentUser,t=await o.getIdToken(),r=await fetch(`${API_BASE_URL}/uptime/nodes`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({name:e})});if(!r.ok){const e=await r.json();throw new Error(e.error||"Error creando nodo")}Swal.fire({title:"Creado",text:"Gabinete registrado correctamente (Backend)",icon:"success",timer:1500,showConfirmButton:!1,background:"#1f2937",color:"#fff"}),cargarNodos()}catch(e){console.error(e),Swal.fire({title:"Error",text:e.message,icon:"error",background:"#1f2937",color:"#fff"})}}async function editarNodo(e,o){const{value:t}=await Swal.fire({title:"Editar Nombre (Seguro)",input:"text",inputValue:o,showCancelButton:!0,confirmButtonText:"Guardar",confirmButtonColor:"#fbbf24",background:"#1f2937",color:"#fff"});if(t&&t!==o)try{const o=auth.currentUser,r=await o.getIdToken(),a=await fetch(`${API_BASE_URL}/uptime/nodes/${e}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({name:t})});if(!a.ok){const e=await a.json();throw new Error(e.error||"Error actualizando nodo")}Swal.fire({title:"Actualizado",icon:"success",timer:1e3,showConfirmButton:!1,background:"#1f2937",color:"#fff"}),cargarNodos()}catch(e){console.error(e),Swal.fire({title:"Error",text:e.message,icon:"error",background:"#1f2937",color:"#fff"})}}function confirmarEliminarNodo(e,o){Swal.fire({title:"Desmantelar Gabinete",text:`¿Estás seguro de eliminar el nodo ${o}? Esta acción es irreversible.`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#374151",confirmButtonText:"Sí, desmantelar",background:"#1f2937",color:"#fff"}).then(o=>{o.isConfirmed&&eliminarNodo(e)})}function extraerNumeroDeNombre(e){const o=e.match(/(\d+)/);return o?parseInt(o[1],10):0}window.toggleU2000Simulation=toggleU2000Simulation,window.crearNodo=crearNodo,window.editarNodo=editarNodo,window.confirmarEliminarNodo=confirmarEliminarNodo,document.addEventListener("DOMContentLoaded",function(){configurarSidebar(),window.KMLService&&(console.log("Injecting KML Button..."),window.KMLService.injectButton());const e=localStorage.getItem("userRole");if(e&&(console.log("Aplicando rol desde caché (Señales):",e),("admin"===e||"superadmin"===e)&&(usuarioEsAdmin=!0,document.body.classList.add("is-admin"),"superadmin"===e))){const e=document.getElementById("li-registros"),o=document.getElementById("li-turnos");e&&(e.style.display="block"),o&&(o.style.display="block")}verificarRolUsuario(),configurarLogout()});