/* ============================================
   NIVEL 1 + NIVEL 3 + FACEPLATE FIXES
   (FINAL CORRECTED VERSION)
   ============================================ */

/* TOPOLOGY ENHANCEMENTS */

/* 1. LAYER MANAGEMENT (Cables BEHIND Boxes) */
.topology-container .branch {
    z-index: 10 !important;
    position: relative !important;
}

.topology-container .branch-content {
    position: relative !important;
    z-index: 20 !important;
    /* Content ABOVE cable */
}

.topology-container .branch-cable {
    z-index: 1 !important;
    /* Cable BELOW content */
}

/* 2. SPLICE BOX STYLING */
.topology-container .splice-box {
    background: linear-gradient(135deg, #3a3a3a 0%, #1b1b1b 50%, #0f0f0f 100%) !important;
    width: 200px !important;
    border: 3px solid #444 !important;
    border-radius: 12px !important;
    padding: 15px !important;
    box-shadow:
        0 15px 30px rgba(0, 0, 0, 0.8),
        inset 0 2px 4px rgba(255, 255, 255, 0.1),
        inset 0 -2px 4px rgba(0, 0, 0, 0.5) !important;
    background-image:
        repeating-linear-gradient(90deg,
            rgba(255, 255, 255, 0.03) 0px,
            rgba(255, 255, 255, 0.03) 1px,
            transparent 1px,
            transparent 2px),
        repeating-linear-gradient(0deg,
            rgba(0, 0, 0, 0.2) 0px,
            rgba(0, 0, 0, 0.2) 1px,
            transparent 1px,
            transparent 3px) !important;
    position: relative !important;
    display: block !important;
}

.topology-container .splice-box:hover {
    border-color: #00a8ff !important;
    box-shadow:
        0 25px 40px rgba(0, 0, 0, 1),
        0 0 30px rgba(0, 168, 255, 0.6),
        inset 0 0 20px rgba(0, 168, 255, 0.15) !important;
    transform: scale(1.05) translateY(-5px) !important;
}

/* 3. LED FIX (Resetting inherited Latch styles) */
.topology-container .splice-box::before {
    content: '' !important;
    position: absolute !important;
    /* RESET LATCH PROPERTIES */
    left: auto !important;
    bottom: auto !important;
    /* SET LED PROPERTIES */
    right: 12px !important;
    top: 12px !important;
    width: 10px !important;
    height: 10px !important;
    background: var(--health-color, #00ff88) !important;
    border-radius: 50% !important;
    border: 2px solid rgba(0, 0, 0, 0.5) !important;
    box-shadow:
        0 0 10px var(--health-color, #00ff88),
        0 0 20px var(--health-color, rgba(0, 255, 136, 0.6)),
        inset 0 0 5px rgba(255, 255, 255, 0.5) !important;
    animation: splice-led-pulse 2s ease-in-out infinite !important;
    z-index: 50 !important;
    /* Visible above box background */
}

@keyframes splice-led-pulse {

    0%,
    100% {
        opacity: 1;
        transform: scale(1);
    }

    50% {
        opacity: 0.5;
        transform: scale(0.9);
    }
}

/* 4. SCREWS (Resetting inherited styles) */
.topology-container .splice-box::after {
    content: '' !important;
    position: absolute !important;
    /* RESET LATCH PROPERTIES */
    right: 0 !important;
    /* Reset specific right/left if needed, but inset handles it */
    left: 0 !important;
    top: 0 !important;
    bottom: 0 !important;
    width: auto !important;
    height: auto !important;
    border: none !important;
    border-radius: 0 !important;
    background: none !important;
    box-shadow: none !important;

    /* SET SCREWS */
    inset: 8px !important;
    background-image:
        radial-gradient(circle at 0% 0%, #666 3px, transparent 3px),
        radial-gradient(circle at 100% 0%, #666 3px, transparent 3px),
        radial-gradient(circle at 0% 100%, #666 3px, transparent 3px),
        radial-gradient(circle at 100% 100%, #666 3px, transparent 3px) !important;
    background-size: 100% 100% !important;
    background-repeat: no-repeat !important;
    pointer-events: none !important;
    filter: drop-shadow(0 1px 1px rgba(0, 0, 0, 0.7)) !important;
    z-index: 5 !important;
}

/* TEXT VISIBILITY */
.topology-container .splice-box * {
    color: #fff !important;
}

.topology-container .splice-box-header {
    font-size: 0.95rem !important;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8) !important;
    margin-bottom: 8px !important;
}

/* HEALTH STATUS BORDERS */
.topology-container .splice-box.health-optimal {
    border-color: #00ff88 !important;
}

.topology-container .splice-box.health-warning {
    border-color: #ffaa00 !important;
}

.topology-container .splice-box.health-critical {
    border-color: #ff4444 !important;
    animation: critical-pulse 2s ease-in-out infinite !important;
}

@keyframes critical-pulse {

    0%,
    100% {
        box-shadow:
            0 15px 30px rgba(0, 0, 0, 0.8),
            0 0 10px rgba(255, 68, 68, 0.4),
            inset 0 2px 4px rgba(255, 255, 255, 0.1),
            inset 0 -2px 4px rgba(0, 0, 0, 0.5);
    }

    50% {
        box-shadow:
            0 15px 30px rgba(0, 0, 0, 0.8),
            0 0 30px rgba(255, 68, 68, 0.8),
            inset 0 2px 4px rgba(255, 255, 255, 0.1),
            inset 0 -2px 4px rgba(0, 0, 0, 0.5);
    }
}

/* FACEPLATE FIXES */
.olt-faceplate-detail {
    width: max-content !important;
    min-width: 100% !important;
    max-width: none !important;
    padding: 25px 60px !important;
    gap: 8px !important;
    flex-wrap: nowrap !important;
    justify-content: flex-start !important;
}

.sfp-cage {
    width: 55px !important;
    height: 55px !important;
}

.sfp-cage-label {
    position: absolute !important;
    top: -22px !important;
    bottom: auto !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    color: #444 !important;
    font-family: 'Consolas', monospace !important;
    font-weight: bold !important;
    font-size: 0.75rem !important;
    text-shadow: 0 1px 0 rgba(255, 255, 255, 0.5) !important;
    white-space: nowrap !important;
    width: auto !important;
    text-align: center !important;
}